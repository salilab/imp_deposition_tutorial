Deposition of IMP models {#mainpage}
========================

[TOC]

# Introduction {#introduction}

In this tutorial we will introduce the procedure used to deposit integrative
modeling studies using [IMP](https://integrativemodeling.org/)
in the [PDB-Dev database](https://pdb-dev.wwpdb.org/) in mmCIF format.

# Study versus single model {#studyvmodel}

A frequently asked question is whether mmCIF files can be generated directly
from an [IMP::Model](@ref IMP::Model) or an
[RMF file](https://integrativemodeling.org/rmf/).
This generally isn't possible because RMF and IMP::Model are designed to
store one or more output models, where each model is a set of coordinates for
a single conformation of the system being studied. A deposition, on the other
hand, aims to cover a complete modeling study, and should capture the entire
ensemble of output models, all of the input data needed to reproduce the
modeling, and quality metrics such as the precision of the ensemble and the
degree to which it fits the output data. A deposition is also designed to
be visualized, and so may contain additional data not used in the modeling
itself, such as preset colors or views to match figures in the publication
or highlight regions of interest, and more human-descriptive names for parts
of the system. Thus, deposition is largely a data-gathering exercise, and
benefits from a modeling study being tidy and well organized (for example,
by storing it in a [GitHub](https://github.com) repository) so that data
is easy to find and track to its source.

# File format {#fileformat}

The file format used by PDB for deposition of integrative modeling studies
is the same [mmCIF format](http://mmcif.wwpdb.org/) that is used for crystal
structures, with extensions (the
[Integrative/Hybrid Methods (IHM) dictionary](http://mmcif.wwpdb.org/dictionaries/mmcif_ihm.dic/Index/))
to support coarse-grained structures, multiple input experimental data sources,
multiple states, multiple scales, and ensembles related by time or other
order. Currently, models that are compliant with the IHM dictionary can be
deposited in the [PDB-Dev](https://pdb-dev.wwpdb.org/) database.

mmCIF is a text format with a well-defined syntax, so in principle files
could be generated by hand or with simple scripts. However, it is generally
easier to use the existing [python-ihm](https://github.com/ihmwg/python-ihm)
library. This stores the same data as in an mmCIF file, but represents it as
a set of Python classes, so it is easier to manipulate. %IMP includes a
copy of the python-ihm library, and uses it internally to read and write
mmCIF files.

There are two main approaches to generating an mmCIF file for deposition:

 1. Use the [python-ihm](https://github.com/ihmwg/python-ihm) library directly,
    by writing a Python script that reads in output models and input data,
    adds annotations, and writes out an mmCIF file.
 2. Use the [ProtocolOutput](@ref IMP::pmi::mmcif::ProtocolOutput) class
    to automatically capture an entire IMP::pmi modeling protocol.

The first approach offers the greatest flexibility for custom protocols or
for modeling outside of %IMP itself, but does require everything to be done
manually. For a good example of this approach, see the
[modeling of Nup133](https://github.com/integrativemodeling/nup133/tree/master/outputs_foxs_ensemble_new/pdb-dev).

The second approach will be explored in this tutorial.

# Basic usage of ProtocolOutput {#basicusage}

# Linking to other data {#linking}

# Annotation of input files {#annotation}

# Polishing the deposition {#polishing}

# Visualization {#visualization}
